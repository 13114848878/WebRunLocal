牛插(PluginOK)中间件-跨浏览器插件开发通用框架测试：

1、解压Wrl.zip程序包到实际的某个空的磁盘目录(切记别解压到磁盘根目录，避免卸载时删除了无关文件)，找到批处理文件InstallWrl.bat选中后右键管理员权限运行；

2、启动Chrome等浏览器打开网页 http://local.zorrosoft.com 进行测试(安全网站请打开 https://local.zorrosoft.com ，HTTPS网站请把连接的通讯协议 ws: 改为 wss: 再执行)；

3、测试连接牛插(PluginOK)系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3代表1+2，4用管理员权限启动(仅限于启动exe插件可用)。
请求连接牛插(PluginOK)主服务：ws://wrl.zorrosoft.com?sid=123&flag=1 点击连接按钮会输出连接结果；

连接牛插(PluginOK)主服务后支持的功能协议：

1)、获取牛插(PluginOK)中间件版本信息，Mac为1时获取本机Mac地址信息，More取更多信息(当前登录用户、键盘和鼠标空闲时间、当前电脑制造商及型号等)：
说明：连接主服务后可执行，返回当前软件版本、当前系统版本、唯一标识、授权有效期、授权客户名称、当前系统启动后运行时间、程序运行路径等；
举例：{"req":"Wrl_Version","rid":1,"para":{"Mac" : 1,"More" : 1}}
返回：{"ret":0,"rid":1,"data":{"Version":"1.1.1.2","Lang":"CHS","ValidDay":"2020-03-31","AuthName":"成都佐罗软件","Type":8,"OS":"6.2.9200.2","Win64":1,"UniID":"AF4D1A1623D03399E3E2F63449CF9B18","Time":9182568,"TickCount":163797640,"RunPath":"W:/WRL/","Mac":[{"Card":"Qualcomm QCA9377 802.11ac Wireless Adapter","Mac":"AC:6C:68:89:EC:9B"}],"More":{"ComputerName":"hello","Manufacturer":"Dell Inc.","ProductName":" 3580","LoginUser":"test"}}}

2)、请求更新框架授权：
分别指定授权文件在服务器上的地址及文件MD5校验码、文件大小和下载验证权限Auth及Cookie，其中Cookie和Auth可为空，根据自己网站情况设置。
举例：
{"req":"Wrl_UpdateAuth","rid":2,"para":{"Url" : "http://local.zorrosoft.com/Files/Update/wrlauth.pid","MD5":"8BBCD7EAD95EFC034B724C4D8A961C03","Size":262144,"Cookie" : "","Auth" : ""}}
说明：连接主服务后可执行，可下载Url指定的授权文件并更新到本地；

3)、指定浏览器打开指定Url：
分别指定浏览器类型Type(1代表IE 2代表Chrome 4代表Firefox 8代表Opera 16代表Edge 32代表360浏览器)和Url参数；Flag意义：IE指定浏览器版本，Chrome浏览器0代表标签页打开，1代表新窗口打开；Show显示窗口类型，默认1正常显示，2最小化显示 3最大化显示。暂时只支持IE和Chrome。
此功能主要用于强制IE打开指定网页，Chrome命令行加载PPAPI插件等使用；
举例1：
强制用IE9兼容模式内核浏览器打开 http://www.zorrosoft.com 9999是IE9标准模式
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"1","Url": "http://www.zorrosoft.com","Flag":"9000"}}
举例2：
Chrome浏览器新窗口打开http://www.zorrosoft.com Flag为1新窗口打开，否则是新标签打开
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"2","Url": "http://www.zorrosoft.com","Flag":"1"}}
举例3：
重启Chrome命令行加载PPAPI插件，插件路径如有空格的情况，空格要用%20代替，路径单斜杠用双斜杠
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"2","Url": "--register-pepper-plugins=\"C:\\Program%20Files%20(x86)\\ChromePlugin\\ChromePlugin.dll;application/my-plugin\" --disable-infobars --disable-hang-monitor --flag-switches-begin --enable-nacl --ignore-gpu-blacklist --flag-switches-end http://www.zorrosoft.com"}}

4)、请求重新注册中间件组件或插件：
如制定PID代表重新注册制定插件，否则执行重新执行中间件安装批处理(连接会断开)，可能因为一些工具或手工误删除了注册表等，用于修复软件功能。
举例：
{"req":"Wrl_RegCom","rid":4,"para":{"PID" : "A22E18F1-95F8-4FDB-99D2-188E5FB12B23"}}
说明：连接主服务后可执行；

5)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":5,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息，Detail为1时返回插件程序全路径；

6)、判断某个插件是否已存在
举例：{"req":"Plugin_Exist","rid":6,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

7)、请求重新加载指定插件
使用场景：不用重启服务即可扫描新增插件使用；或插件调试时，程序及配置更新需要重新加载时
举例：{"req":"Plugin_Refresh","rid":7,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

8)、安装范例插件
请在输入框中，分别输入如下请求，然后点击发送，完成四个范例插件的安装：

{"req":"Plugin_Install","rid":1,"para":{"Name":"无界面DLL插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-11-05","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"40DECDA507AB60344157212997BBF5C8","Version":"1.0.3.3","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"82B2C1BD0890BA9694253E861DF1B829EC68AA40609E7EBAF2F8D0078B152B81C74BFC3E1F3011ECAD18BB4D8778A6B93D7E449C29A41D0B0B0DFE2C18B35B26B5AA82682B2565DF55A22E5871FF1EC2A7A6956CE8119A93A248E0DA56913192CB4F127FE330F3EA22688BCBD77B0DB0CF6509D0777566B6F35BB8904B38B3F31EFA300812CE987EC052099375ABC954D603343D24A717DC3F1993543A43D8B3E22D1F41735756537602D314A364CBE0C0E9C93108678AFA5136A2ED986506C9E4D0B2C1F9FDFA6EAAA5CEACF2D3B9F0A4B75A060CB783BE8198589410E7196C6C81DE754FB0BF1170EDA26AA8279A1472F3449B36AE182EEF93CDCA74CE3323"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-11-05","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"E1CE4AC3A44A8B62DA87EDA708A01E29","Version":"1.0.3.3","Size":589824,"Type":2,"Cookie":"","Auth":"","TK":"8C13C24B55844D73B923631895997FECF0BB8465D4327402A04A537730DB46EECA8C59AF30ADFE058FE000127C70E38132847320FD4589D8225445913A5EA57F3BEB7B3C88503B35CE59592E0AEAFE05361A7BD0F092986F406ACD85F06220F4E861BAB9B2DE131BFE7ADA7899A43E040AB89281A20E703F4CCABB19D27810CCD383A273C96590A1274DD2EF5567C011D13D58E9E0A8E9E34023B32007ECE5A101F0F5389F40366C98078C9BC53D06D54B1549B365480DF7898B0565515FF5BAC34D12037DA1FECBF9ED53BAF0D6B257425067E34CED465EB8FFD77305CA13217267D09416D4F655F76B65035F08265C56E2BE323356690F15914E6AC81954B0"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#版无界面DLL演示插件","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-11-05","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll.pid","MD5":"3472EFBD251815EF01FCF6546F86B5D0","Version":"1.0.3.6","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"09D23B30E9769F669B0E798FFAAE946B4030C442F2ECD490D2E7F52492DD5559E858DA0EE3D41DCCA6C4AA16EF430D5007CE2FA62D13EBCE3CAA9BEBE1AD8D47B6585503B7C0C7700F6C1B8D7A2F532FD7BDFDE96E0CC95D1AE6987C53A86F7F06136EB4C63AB06DE67C083A021DF3EE354FA1E3117DF9EE3597F735A9E3BE9D4842623B2F2A2744EDD4A1CC65DBA10E166023DE1C6BC3F8BEF0BCA909104E98C3B255544FCF16DBA3BF16B01BE8A6221D58E67D4677A8CDF81E8F96E09C8746B1DCA3166A0FD032CACBDF2A41E83DCB7299B8884C66F47B6E89B21AF9E9FF62675BCD1ED97BFABE14B5A18FFAF5A1604F1C41AD21EA47C2D47D00825E9FC027"}}

{"req":"Plugin_Install","rid":11,"para":{"Name":"C#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-10-31","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"59E3DED018528DE318517008EB541816","Version":"1.0.3.3","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"C3A8DAF8F3D18BC420EDF84C118A53181C290A7CBE156D4882667C7F5A6F4254538DC5224D5850E62A8FD9C37E1AF4CBB2C5BCE2907503C40934F13DF055D4686E7D9CFAC2FA67176949B6B59E64A586AF4B3B67F38AADFCED25CA42A71FA6D0E96C144A2865F50EB412E6D78F2D9ED44A6B95DC7BE613A814603A1B9C217A06E143B817FEA33A08026F85AF7A16723F42AD81D692FA873135C8C58FD34F3D9F419537DD94EA5884523BB289B87F160355A831015250AB8CF4C49A16E52819CE6A38CFCFC1CD992739345C71D98569025DF591312D4FB30F7E54F8B53377D9B097815E43EB0D28A423C08A79CEC5E8C53C9F68CA91338E842D3CF32654621776"}}

9)、范例插件升级请求：

{"req":"Plugin_Update","rid":1,"para":{"Name":"无界面DLL插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-11-05","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"53B9711E1EDD4F0E7551D44E8926A98D","Version":"1.0.3.3","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"ADFE0DCC08D3B04C3F3F8E9987E1E0641FB4072DB76479860F9CD8C8FFCD4D19091834108F6E7AAC53BEAE7216C6767497D615A1C97073278EBFFE8C2FD7DD60A0115CF4E6FC071C8CE60CEF3A7B27BA8B3B6D7F8745934173537CD255AE9D09EBE7195DEF887D4F5F6B39F8C9DB0B98448E94F96AEBD1472C9C96712B32356DEF327DC6250669E3A4EE3764D28C966D6B5B32437BD53E0494BF59A2C9821E3FE1499D7ABE61640B76F44B9A89AAA23BC4365F97D2F4E7C7FB0BAA1B0F5AC5AB74C21CDCFF1DE7A007999EE562A23AF3BD2769C6BA188F406FB72EA1FEE326E40721F8F404C560A2C5A44BE17C40DE2C6A3882E952253BA59DF052D285CCC35F"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-11-05","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"CF0C9B648B29B7206D445D3517070807","Version":"1.0.3.3","Size":589824,"Type":2,"Cookie":"","Auth":"","TK":"75BB17E144B5F902E59DE732305CFFC8F94113018435F7AEB5D44D364094A0F1CFD45ADF39AB1B1493E23D6FB44EC2B1775A65F1B5713287C26C9ACEFC48B910649ECD8A98CBE27C70101302D30024413D55D0645590E16EEADEE4BA74973EF60ECE9364326D0F954387FD8BE8E3CCD0D82A75686C814819BC5F76500C010B6950BFF6BF7188A3A2581D340C4967ECEC641896786DD5816926036A80CEDFF798C6955113D8D1E22B4B79985CBB04E46A47DE66017A5A66CF9CAACEE861C94DC503BFE9B6F8E91A8DFDD4D1B69361B83C26396B033CD3999ED329160B612DAF51A568CF616E5936F4AB60F7B916040AA09B404488092DAFAEEF1E7D079329BBA7"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#版无界面DLL演示插件","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-11-05","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll_Update.pid","MD5":"3C2D7239355DC1AD2DD5B66B35A9CA16","Version":"1.0.3.6","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"4AA35BFD4B491C53E8AB723E0496B1C8B80E243ACBB21833E6A2E5AC79ECAD44893EEF2634F14835D962875E568EF9815A4A529BD86041A9E5D49ABA0D93D84344175F5657D4087D9A599EE3D3A7C647D5F5CB8F21A5DC5186A13D810013BC11E576637CF1588519E890A7B5CBE4BBE1FB17A77218DE6B4E3743095E9C135D0A791E52FC1C6CED1019B8D587A22755D626D37EE2F5495CAFA23FC0E6E17958B3C618135D9D78F074601E9828D6DBA28D24FDA3E66423DE2DB44B1EECA7B2E0DD21B88804E3BC5D46FAC17CB1FDFC3AC057E57FF09F8C8B95A373E5484832DA84D2B92B36E1DEB5783967C5EF60C96B37AAC493763A2C3472544CDC103F1039D3"}}

{"req":"Plugin_Update","rid":15,"para":{"Name":"C#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-10-31","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"72175FF0CD020043E46B7172EE7BDE2A","Version":"1.0.3.3","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"B59817BB5982AE1317F02F15AFB79DD95280CDAC1879107D245A9BB808D02B23C578869472DDEA59B56384A56A5346E05038F394541AFDFCD78403AC720243F885605B87802416E6E40AE5F60129ED6EE14B889F2573F6AF3C424A9F172E639C80CE5DCEE75A6F36377B8D6BB02ADE504E31B9058D28A5C0909D26234086405DC41E74C70E0B39B766D75B828F9D9E211BB6915AF8FC772F59D5FF9FFB6F5AFB4B0DAA906C207AB2C8348AC410C4E0DF559EFDC8694296E8F4E295541F6E7B49408A69A8436067A7135883BFD0EED31506B15C3A10FA5151683928C8D6FFFDFBD50A8989456BAF7AAC5A160741944B5A5D95DD6B9794A0183F2B734B641BEA91"}}

10)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":16,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":17,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":18,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}
{"req":"Plugin_Remove","rid":19,"para":{"PID":"D10495F4-DF0F-44FA-8647-91275347214A","Type":1}}

4、牛插(PluginOK)框架升级请求：

{"req":"Wrl_Update","rid":1,"para":{"Name":"PluginOK升级包","Date":"2019-11-05","Desc":"解决正式版授权误弹未授权提示；优化一些协议实现","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"E58C6250DB61FCB405E669154AF6984B","Version":"1.1.1.3","Size":3407872,"Cookie":"","Auth":"","TK":"1D9194B5CC26F2854F1A9E140746C9D3251226E9174EA4C85633E05CDEB8C9D28164896DB7D281A816F4EDE546AD1ADE7FBFF20423C82D66A1E35CBC9F167394FBBCFA43FF7BEDF75030705C1C9EDE74CFFFFD3F80DDAE4D46569400B485F3AB719B4731AA610E5392BCBEDD29711DCB2891EB6264EBEF2CC5941AE202D0A17C574642AC3FAC1AF169EB4C8350DD9B23AEF963AAD63763641694C47910626F9BC82C919FAE49E054F079B64BABC9E02A614BAD7D5000877EB135C051C4619BF890D1D9B5204881CED08EB40BE38B83E1BD0CC13E5A71F3A5FDAA91385D0C033BA59AF80766A8D12D9C871148AE9E2EED2E3315FAE5DBAD9B241F0074A3A3CB2A"}}

5、请求启动C++有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

6、请求启动无界面的插件(dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1连接请求指定pid的服务；
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":20,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":21,"para":{"Name" : "牛插文件插件.txt"}}

7、请求启动C#无界面的插件(dll)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=FCADA8A7-D975-42c6-B5D3-FA40F6FE1286&flag=1
其它步骤参考C++无界面的dll插件。

8、请求启动C#有界面的插件(exe)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=99225C6D-B7A3-441c-AEFB-3EE23ACA2209&flag=1
其它步骤参考C++有界面的exe插件。

请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请联系QQ客服：188872589 或微信客服：EMeiMonkey
