牛插(PluginOK)中间件-跨浏览器插件开发通用框架测试：

1、解压Wrl.zip程序包到实际的某个空的磁盘目录(切记别解压到磁盘根目录，避免卸载时删除了无关文件)，找到批处理文件InstallWrl.bat选中后右键管理员权限运行；

2、启动Chrome等浏览器打开网页 http://local.zorrosoft.com 进行测试(安全网站请打开 https://local.zorrosoft.com ，HTTPS网站请把连接的通讯协议 ws: 改为 wss: 再执行)；

3、测试连接牛插(PluginOK)系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3就表示输出日志同时进行Gzip压缩。
请求连接牛插(PluginOK)主服务：ws://wrl.zorrosoft.com?sid=123flag=1 点击连接按钮会输出连接结果；

连接牛插(PluginOK)主服务后支持的功能协议：
1)、获取牛插(PluginOK)中间件版本信息，Mac为1时获取本机Mac地址信息：
举例：{"req":"Wrl_Version","rid":1,"para":{"Mac" : 0}}
说明：连接主服务后可执行，返回当前软件版本、当前电脑版本、唯一标识、授权有效期及授权客户名称等；

2)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":2,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息；

3)、判断某个插件是否已存在
举例：{"req":"Plugin_Exist","rid":3,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

4)、安装范例插件
请在输入框中，分别输入如下请求，然后点击发送，完成四个范例插件的安装：

{"req":"Plugin_Install","rid":1,"para":{"Name":"DLL版COM插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-06-28","Desc":"DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"B90CE1ECC5C72F25BA0FAEDCB9DED6C6","Version":"1.0.3.1","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"BE75AC6395CB44162408F5E7E695A415272E387F57D7B91EDA35C5A2683C665990A2F1424DC5293BB0383E80C32B1D7115D227ED590055F513B5EDA89AAC5890DA436132306DC765E9E2562D4B5B5663E0BE37FAF939F464208EDCFC5BC76C88085C3ABFD68BA63A0FB5F282D086F55F41CB76BB6DDC875821ECD0E5507E90E88CD9EDF443AD6B7820F7E44267388C700376688837093D7FB39FD18A34A91BAB42628925B935C97627F56D2C7AE55F4F88403ED30D364A5C385BF7F9D1B7F39EA5BEB23568F427B3E0A4EC80E767EC977BEF6242CCC3CCE700EF66B346F40D0B34A5AF54D361D62A54C1418B14D1B6FF44EAB182CEE084E7592A6E37AE6E1C74"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C++程序插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-06-28","Desc":"C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"35827A84AC783CA9DCAF04D15D14A2A6","Version":"1.0.3.1","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"0391482D54C12A22C41628A1B5EF4C035722BCAFD836E458024C50D2290C4AD3A2AB64C04B9197E6D7DAF27D81C93869E3AF2FD96D10AA1D1D5A116B015119A8353FF80303EC8B108557CB38CA9A4F9A4228B8C9FAF3B08E12504F572FB7596251698A6D37869736FC89DE638DCE9D1B17CD8AFBE580F4B7159C0AAE015A973FF0C68E857F88E499B6FE1E65599EC521F72A5FA9FB5B29DDDF2E5A7C478ADAC610D2F9C3A491C77D617821FBB5F83D82260FB9863A87D73056928AFD0AA42CDAFF837C2301F0FB6EC14E3D1780A63BF3D95194AC0749AE4D6891FF9738DCAE4699997E918ACA8BCB454982FF8DB633E89D5372C4C804EC224E3EEC30DB9B54C7"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#语言DLL插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-06-28","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll.pid","MD5":"CA68A6946BA2FFB310D5E1A336374249","Version":"1.0.3.1","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"B09657E21437FE80C2DA7E6531A8037D74E22FAC39110190EF71F14A31EEC49AC418B1E58A868540C027AAFEAA96D4455C6B07C49510B1A74B33715AD59C108DB4590BB4B8804918FFFEFE90DD3B881F02047F0EC9E06F1E6EE31E3CDBEA9A5F1AF155FDF79E41279C94E5BD0BC15531AF0E074436D07F0F5F2ACFB9F070BE155BA00A595DAA29150908725AD4F0B130026F8B9CFE994E17D4E6E2FF4185C1806CAC5DFCC7F5D5C8EC5CF29278AE33CD69ECD5E3F44483D69FBCAEB11256F77798B4533963E785791C178429FB986B471ADBC4EFA9472053E53AD89BB01CAF25C8A843ED687ABE0887CF218532631B665F48FD9B1A468A427BF51FE1630A98EA"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#程序插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-06-28","Desc":"Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"2FF3D22E65A8A1792C1BCE5396BC9B84","Version":"1.0.3.1","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"2C0F45AB85214135F63B784609A67E205460621ED84B9868B513D3678B8D853E134D42DBF1686E0BD90075CF928190AE3A410E0E4A9CCDB381DC05239CE94F31F9B8BB9D6DCCB198216354A887DE83CA112C5046FB6E85B950CF0E4EF650A7B0AB577B9A34B95F4ADAF5D2FD4757276CB4D5A9D859F56623DC2510C287C516A65D6C64CFED73E85980D891E2EC24FC0E52D928049A8981609B23B218F484976586E0787ADC9235157EC7A3F7BCAAC8635A14083D89EE6D1884A89157081D94A5AEAC3E9633AAF470FBF03FAD757B86F29781FB29FB6B97F1AA3A8AC6AB6F2180179980A6DA54D98DE42FDC4F00AAAC184435C46B41A694BB7C4ED9E93A76612A"}}

5)、范例插件升级请求：

{"req":"Plugin_Update","rid":1,"para":{"Name":"DLL版COM插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-06-28","Desc":"DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"D6647566DCBBBA60B55F54F96FC7A89B","Version":"1.0.3.1","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"AE1C3561697588C471E13CF32D47F1719E06DC1B07329444C705B60D012E4D28B9CBC99A25E8B474B5D88606023AA4BFF31CC7936AC5917D49DF1F4FBE76D25343AF793E4300F450C4424A12E1405A53DCABF8AF95736F9DC83E03E52281FC95A594CD57A30DDEF58B4BA507758D2AA2D3952075AD4EECF88B09B8B6B3CB523278ED062E2E5F80D7FC839C9C1420A5D5ED234F2AF041CD430190EAF53C4740D9F50167EC0EBAC91A056E45C778280C71E67A28FBF1C70D107A0EECE9AAD25E5957368DA766D1640761421FB022B6AD2B1D522F7F4369C2CC1D4667A3D368805C877A46A87191C4C9A0E1D4B61EF20EFA21D82BA4253AA2B0E4DC6A56ADDED319"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C++程序插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-06-28","Desc":"C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"DA3572614CF044EFED7A500C06D7E1F4","Version":"1.0.3.1","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"332A5C9EDF7A32B90BA26220DA3C59A8CF2B80825B7AF1565F65C792C904E5039E6D530B0857A1D5F6A54C75D0FBFD0972A499F9A56EA2185F299420960C13FD162DB2AA80F41B39CFD5E9448FFC0767140AC98630DBF646FE117DB7E8CD1FC09BA88257766369F2A9E28E79D06F36C7F174A300A51163956979F847850D7BCD91C09E8D08D6197D144068643A993BD4BC987BD6F0740907ADCDEF01107BCFBDE243B478A67F90317E4067E64803D17D6E3BAC6B4251FCDEBDC860AEDB785D4C5E675F0CC38DB21DA44F0306F9F8997768F4F337B90C7E909CC8A95A57D6E234E667996CC535F48D00662B27E398F6E0F462E6D866D67BB487AB27E889A5100C"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#语言DLL插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-06-28","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll_Update.pid","MD5":"167CABFEEBB16D0FBE1DEB309D799448","Version":"1.0.3.1","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"300AC2817217F781ECAF7D68F6F73B157C42240BE13C06B2A52D1C9B59E658FCBFB8B08113D7ACFC06D9693B4B549AE96318574D4F0F88F7AEEBFF346E1AD3EA178EB1F09409ED47EB9AD2833DA4074AA9228DF6103A23FE837E1D8B25AF33ED179D3EB4975FA77F0B58B919C7E4AAA3BEAFB2210DE37D2EB4488D2C4E4BE5BC2F435D1D14A4FBAE0E6A18026DC19B52B1991280EEE916ED569E4539C23A91F8123AD9B70CDB3CB433F1AC4FDBCC9191C25E16D530742684738BCDCC56C566956668A9485F95E5C418EB6651452C5E27290ED2CAC84A3F4F5A7C8FA251DEEE0F053EF1124A83F0CEAD57E60C953FC120CA1436B797645F1C40915296128FA8E6"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#程序插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-06-28","Desc":"Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"62784351C8F65A41B7C67EFE45CD6A11","Version":"1.0.3.1","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"B83055B26EED42C71EFCB18401DE4DEF63DC09691A5216D4DA7E8EC276523A8654789CBF16DEDF7E6979D451126D419A5B726BB92AEC047BD0B84ECB00C9D354E8DBBBEBC0E4DA77B9FAB5F6C9D499018C927AAC4F5CA09E22CEC2D5A2CBF9F551DC14F1EF41BC78A987BA58F51AF11B2D3D52F422513AF4390C7335A9CC69A3441347A5182ABA3B154E0DE0134DFBAD51148848244775D7C98AB451E733F90F3B0F824AB5CDBA251948350043A329E6F26639F9156A901CA6FA2D412D925E470D24D1E8EFDE5D1507CABE9DBD0F9E56A194AAF5345E0D9B19D1A72DFCA6A5BD63EC1F22526EF3BAD0A6AB1E89611E30228BBD0F60A2EA063CD28625513CE837"}}

6)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":1,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"D10495F4-DF0F-44FA-8647-91275347214A","Type":1}}

4、牛插(PluginOK)框架升级请求：

{"req":"Wrl_Update","rid":1,"para":{"Name":"PluginOK升级包升级包","Date":"2019-08-20","Desc":"1、增强插件DLL加载路径依赖；2、版本获取时支持本地Mac信息；3、解决打包工具文件大小0时执行无法结束问题；4、解决授权过期时服务不断重启问题","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"F9372E9879A7E831516505CCA9028522","Version":"1.0.9.11","Size":2752512,"Cookie":"","Auth":"","TK":"8EB058E4EBB75A6F22E24681CC905C67162FE4D066A51C51CA71B22FDAAA1BA9DB1BC825E09182F2F71E501ED28362F3068D03B90CA622512B04BC92F0E48EF67F4E779E5B1C8B045CA1E64D95D805FE6FDDBD3F652959A47019A871960E76DFFA8BB48B30EDB9F93D360A3942AF4F35E1FA5B73EA492FBC9675BA1D80EA733C2081E2EC6F123FC2F984D346ABDF4EA0A97BD8F7FE0DFF7A62E68A0BFF0920C43E3EE721C422D3057DB2844E258E887D9C190793C8A163004F02CF6D6A4E23022E4261836B6A6F3219CF7474B0649B592B34F06029F8E5AAADB9C3F8A5217840EBCEBBE79F048586936DF845B47614D604204044D18B0272217F07FAE9B50E59"}}

5、请求启动C++有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

6、请求启动无界面的插件(dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1连接请求指定
pid的服务；
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":2,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":2,"para":{"Name" : "牛插文件插件.txt"}}

7、请求启动C#无界面的插件(dll)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=FCADA8A7-D975-42c6-B5D3-FA40F6FE1286&flag=1

8、请求启动C#有界面的插件(exe)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=99225C6D-B7A3-441c-AEFB-3EE23ACA2209&flag=1

请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请咨询QQ客服：188872589或微信客服：EMeiMonkey
