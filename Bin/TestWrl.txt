牛插(PluginOK)中间件-跨浏览器插件开发通用框架测试：

1、解压Wrl.zip程序包到实际的某个空的磁盘目录(切记别解压到磁盘根目录，避免卸载时删除了无关文件)，找到批处理文件InstallWrl.bat选中后右键管理员权限运行；

2、启动Chrome等浏览器打开网页 http://local.zorrosoft.com 进行测试(安全网站请打开 https://local.zorrosoft.com ，HTTPS网站请把连接的通讯协议 ws: 改为 wss: 再执行)；

3、测试连接牛插(PluginOK)系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3代表1+2，4用管理员权限启动(仅限于启动exe插件可用)。
请求连接牛插(PluginOK)主服务：ws://wrl.zorrosoft.com?sid=123&flag=1 点击连接按钮会输出连接结果；

连接牛插(PluginOK)主服务后支持的功能协议：

1)、获取牛插(PluginOK)中间件版本信息，Mac为1时获取本机Mac地址信息：
说明：连接主服务后可执行，返回当前软件版本、当前电脑版本、唯一标识、授权有效期及授权客户名称等；
举例：{"req":"Wrl_Version","rid":1,"para":{"Mac" : 1}}
返回：{"ret":0,"rid":1,"data":{"Version":"1.1.1.1","Lang":"CHS","ValidDay":"2020-02-29","AuthName":"成都佐罗软件","Type":8,"OS":"6.2.9200.2","UniID":"AF4D1A1623D03399E3E2F63449CF9B18","Time":1572526807,"Mac":[{"Card":"Qualcomm QCA9377 802.11ac Wireless Adapter","Mac":"EA:5C:68:89:EA:0B"}]}}

2)、请求更新框架授权：
分别指定授权文件在服务器上的地址及文件MD5校验码、文件大小和下载验证权限Auth及Cookie，其中Cookie和Auth可为空，根据自己网站情况设置。
举例：
{"req":"Wrl_UpdateAuth","rid":2,"para":{"Url" : "http://local.zorrosoft.com/Files/Update/wrlauth.pid","MD5":"8BBCD7EAD95EFC034B724C4D8A961C03","Size":262144,"Cookie" : "","Auth" : ""}}
说明：连接主服务后可执行，可下载Url指定的授权文件并更新到本地；

3)、指定浏览器打开指定Url：
分别指定浏览器类型Type(1代表IE 2代表Chrome 4代表Firefox 8代表Opera 16代表Edge 32代表360浏览器)和Url参数；Flag意义：IE指定浏览器版本，Chrome浏览器0代表标签页打开，1代表新窗口打开；Show显示窗口类型，默认1正常显示，2最小化显示 3最大化显示。暂时只支持IE和Chrome。
举例1：
强制用IE9兼容模式内核浏览器打开 http://www.zorrosoft.com 9999是IE9标准模式
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"1","Url": "http://www.zorrosoft.com","Flag":"9000"}}
举例2：
Chrome浏览器新窗口打开http://www.zorrosoft.com
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"2","Url": "http://www.zorrosoft.com","Flag":"1"}}

举例3：
加载插件路径如有空格的情况，空格要用%20代替
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"2","Url": "--register-pepper-plugins=\"C:\\Program%20Files%20(x86)\\ChromePlugin\\ChromePlugin.dll;application/my-plugin\" --disable-infobars --disable-hang-monitor --flag-switches-begin --enable-nacl --ignore-gpu-blacklist --flag-switches-end http://www.zorrosoft.com"}}

说明：此功能主要用于强制IE打开指定网页，Chrome命令行加载PPAPI插件等使用；

4)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":4,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息，Detail为1时返回插件程序全路径；

5)、判断某个插件是否已存在
举例：{"req":"Plugin_Exist","rid":5,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

6)、安装范例插件
请在输入框中，分别输入如下请求，然后点击发送，完成四个范例插件的安装：

{"req":"Plugin_Install","rid":6,"para":{"Name":"DLL版COM插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-10-08","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"B03F3C6FAB05CE08C8247BE7985C4851","Version":"1.0.3.2","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"6DD6C390F158F801218D68596D62F4B97332548E77815E3C66111BDDC7BCB2C69693C299069D46388EF9B99C30120B1DE5B031137BBB90E8FB474596832F47F1C37437E700B84710F03A2555EFFE9181266908799E5DE5EA0D215EA6F485048F2FAB76EE7BD4DAD8B9B72490A490CE55F53069E7009C84A791BCA4F705A8E1C7D5AA472F9CC24E6641E0FED18D69D49FBBF21191CBE178885FD095DE751C2D6C0EF2E1AA8EFEFE7727A21D15DFA2254776A4199BD020BF19AEC62E54AD9CEC69C83708D117B366A000AAA99B41DFCEC6D76CE3ED56564901E0BCFBCA8C12CDB4E4BB507F5BEB75D5B7239EEFBBA17F0891FEFAF6CFC1B14A9B5D92F49D079705"}}

{"req":"Plugin_Install","rid":7,"para":{"Name":"C++程序插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-10-08","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"F471516996804E1208DD8D6B2948C862","Version":"1.0.3.2","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"4DCCF6B605FC44B94086FAA0438CB797979EDF6B68CC97AC13CBAC4B1FF28CE28611601E0CDD6C0A375B93FEF9001112A057BACBE28A8D1FB806533D80AE482636892ECB5396B9F158615B6D55696BDC08E70A736EF9C4F0ECCD15E671E7BA3F48061E0BF6DCDECF863BDDCE25D8946D133DD96EEAE2541146D8A26F3CBD76AAE63B5C2BB723D692113F730597B0CCF53CAE05A07672EA44C1DF0C9BA8B935CCC73AD8F183A3C5B158C4D7F3B141E8CCBC06E1DD1731BB503EE963DF680BFF6A4A1698D06237AAB9109F27C2A3BA81A61E3CFD65788D3C09BE664BF078B5E949C6D7605259DE13EBAF6F94B39A0757283DE702337E339ECF50275AA57E18D30A"}}

{"req":"Plugin_Install","rid":8,"para":{"Name":"C#版DLL演示插件","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-10-08","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll.pid","MD5":"9A1CEA4C47C476F52933B209678AA48D","Version":"1.0.3.5","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"BA28ED39931E9C139D22E4836A4742DCAE7268F942EFA6DE62F49A091D2362D85D9290DFFE9B2A6235CB4E4EEC07D706CE5B619BE976F271277AB7849E4033BDA9EC3B48BEC07418730851177A645E41AD8A50C6DA9B9C290B49736734458CA196B4508E247AA2D1989932026665533F52AD9F78747C7E5EF211E11D351F509E276027CC0588CDB409425E2C7212AEC8C5FF0BB209D7FB0E7383156EE26E2E43DA0ED4275AD9D4022E2740E1BF72AEAFA1CF103214AC778917956F113472DAACF66B369FB88867F5D4E26902103A8199235A6EEC55B9638EA8FF4AD6E68B3D6FF961DF24AF18AAC303C69117233BE8ABAF0B72812D778A736D4BF879A95864F3"}}

{"req":"Plugin_Install","rid":9,"para":{"Name":"C#有界面插件","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-10-08","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"4C2AE99AB3D1BF7311AFB3AB3817FF4B","Version":"1.0.3.2","Size":393216,"Type":2,"Cookie":"","Auth":"","TK":"6C629374E52596A744343B5B2FBBB9891F5D64D88DEF8453DA59E3C6EF4089B84135AC0C7F482635384D14AFB20637DCF75A1969B5B2FA137A29BE596362FE272E6B0F555B71FE9ADB5E90B13BA40A553139E9BEED60E9B4BDAA319B3E409975578D739CCDEEAE6EA47A7402D83B64DAFB4EE7FEB2244012661124460CE5506B3A98CA821B4FFB4A789F0924FBF57CA5FF9ABA4200F9DFACD535D0DF35F462EC8B534E28A008099DA20F79E899A98C85EE81D62DEE44C4F5EC7AD21C5F1FA94239801549D1E346CD96012AE77BD276BDF501446154AD8E763644B2F983041569D91A5B711ED6D49491896F3F28E60E71982F1677724DEFA9B9422E4CE7D82327"}}

7)、范例插件升级请求：

{"req":"Plugin_Update","rid":10,"para":{"Name":"DLL版COM插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-10-08","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"E0E9ACF5FBCC56C6572A5A8342965047","Version":"1.0.3.2","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"50FFD446D0BB2EEFF35527AA5F4A26BBCE6AF237050D3AD4C58EE7ECA784D716703737A6F9AA146082DE910DC97FC3113EB917DA7DEFC9FF72651D8845C8EF894DF7AEC43E763E9C5D2FAA7605E832CE0EC4793B7E1C12BD70F4A5A8726C08157C941CB4DE8FA40F518F8F4C3309ACCCC1884F9B78C43CA38436EBE67DD227F4900ADC54468E5A0031742A85E43805F6AB6145CAEA844ED0486554C0C8CAD561A490DBAD8A6E8B3E4AF321CCA74A6AB334F725787650DC982FDD095F3905414D1FD11C2585CE0DE31A474C37FF7A6E1CCB630CD5B06F4D94D417324A08E38804A47F5DECC3B52A74F70092D681E1F33004616ADA648F891FB3C6A13EFBC99725"}}

{"req":"Plugin_Update","rid":11,"para":{"Name":"C++程序插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-10-08","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"A43DA88AFFC24E4A493F965564C3D42C","Version":"1.0.3.2","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"8D75834719A00FA00121E8CD098C63698689AFBFBEF9F025F374A3A40767B665D11A0B1CC60706C35ACF6E5683D0B67B4D13D09794BEEF5E8BA6FE9BA3058CA42A29410716DC7CB8B559D7F1C66BB129900C9C1D7824F4B0C7A91EEEAAD507FA7323A84ACADCA7E4FC2E76FF76885499BC93DC9D7249459097F78834CCBCD72ED3AF0F3A5E258C7B532F8BE47F2B475569D3D8FE72D1BDF02399D46FE2DF4ABB1F93C605400E444D743B258DF1EECB134F3B10E5825656A2D5752D41AF9D2064A745CFE1FF33B0B4D10C7D99955661521C91DB9AF507E5C5F2AF8648CF571DD0B6867801F501EE3B0D275AA14E3A223C53211D8533B6ABFC635099B5C54BB995"}}

{"req":"Plugin_Update","rid":12,"para":{"Name":"C#版DLL演示插件","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-10-08","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll_Update.pid","MD5":"A3ADDC4CBD2239F1C4293FF87C696E51","Version":"1.0.3.5","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"AF2AC950BA9F16DB25A8FAD8805B73DD96DDE14769E9FCDD6A73B9E86545EA50B66CF6E9165610F547C5A0ACB4E3FC44A78C19A1D845A67801EA5A1F802635EBD00D45831BBA49A829073E2A8F6C0597F8D427999CE94F3F809E335C04A7CC590B7989CCD820E55C4B5CAAB75BDD4A6B3453BBE8F096CF52005A73C8AE1D5BEBE578B5FCE07B499D711B65889E82C45718B9AE94348BCAF25DA10AFE647CE43102BE4CAC80DD58ECCD40F04AA2E75608F4DE4F1B370A56B7C4DE21D5E9E325941748F037BAFB67A43D617373D97258A568B751C8887DA7904EEF1B07CF9B41A7980997747C519196C3E49BD23F4E97B0BC66EC102504C193AC8BD81755C5A083"}}

{"req":"Plugin_Update","rid":13,"para":{"Name":"C#有界面插件","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-10-08","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"CD6D843FBB3942B0AD41D5ACD3C3355F","Version":"1.0.3.2","Size":393216,"Type":2,"Cookie":"","Auth":"","TK":"5F31F412AEE8E0A85C25BA3827230E611BF5CE58D78D6C83532F91310482A557CA002D9CB7687B6CF9C44883CE8FCA47C81FB1A673A9611BD1AFCD65817DA609BA9FB06523E4C27D118661BA840619F1008EFF4019A0E2263C07B5C1E0581524A780561F26B0AC03D45F4D0F7D95290A10DD089FE77B5F8023CDBDFC26BF8FE812D22AAEEDF8E8FC326D280F5F32E328C0972387B71AE2EB822374A8B8CCFE3E3587E862FB8CDC8D7B18ACA7238F8DEBC76089C87A57CD98D8A829F38401180FBAD7FD719FF36A38E94176604F63A573346B843222660FBD60096EA4D7E821886ECD558E83F2898038F2754B4EA6C922DEC357FBCF5F6D63D2B03B0538ECEF39"}}

8)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":14,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":15,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":16,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}
{"req":"Plugin_Remove","rid":17,"para":{"PID":"D10495F4-DF0F-44FA-8647-91275347214A","Type":1}}

9)、请求刷新指定插件
使用场景：不用重启服务即可扫描新增插件使用；或插件调试时，程序及配置更新需要重新加载时
举例：{"req":"Plugin_Refresh","rid":18,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

4、牛插(PluginOK)框架升级请求：

{"req":"Wrl_Update","rid":1,"para":{"Name":"PluginOK升级包升级包","Date":"2019-10-31","Desc":"支持静默安装；支持指定URL打开浏览器等","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"D9F73813087431C3BBBAA710F146115F","Version":"1.1.1.1","Size":3047424,"Cookie":"","Auth":"","TK":"6785FB83B5B7B2EA4C3B96C50AB88154F7BFA5F14B7102AC8EE0F7F575EA21EE68C0A8BC196C055431E177F9B04273569DDD09BB2C08E9A4FC8B595244670BB988786DDC8E63F441265517DB1AA153017583B56EAB6F65B14DD5567DA58346DC141A992DEA7E95A762AC4CDA826DBCDB625C5C8DF434F6A2186D77B83B2F72CD1F0A1FA31BF935F1705E7574BD42AD141671D2BE1AB7FF89B4BD3DEF293DD07C8EE4B52ABDA9B0581315093CBEE4613C71BDD50471B70CD7142F1080C926432C53F309BFBC4FF931D520E46ADC96C8CBEF1FE2BA735BFA3721F658D8B0356AAE503A737CD85A8CCA78C6096A916900C5641C363ECDFE2481DE85DD1D33E417BE"}}

5、请求启动C++有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

6、请求启动无界面的插件(dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1连接请求指定pid的服务；
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":20,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":21,"para":{"Name" : "牛插文件插件.txt"}}

7、请求启动C#无界面的插件(dll)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=FCADA8A7-D975-42c6-B5D3-FA40F6FE1286&flag=1
其它步骤参考C++无界面的dll插件。

8、请求启动C#有界面的插件(exe)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=99225C6D-B7A3-441c-AEFB-3EE23ACA2209&flag=1
其它步骤参考C++有界面的exe插件。

请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请咨询QQ客服：188872589 或微信客服：EMeiMonkey
