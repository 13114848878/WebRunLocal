牛插中间件-跨浏览器插件开发通用框架测试：

1、解压牛插程序包到实际的磁盘目录，找到批处理文件InstallWrl.bat(执行前先编辑写入安装文件WrlSetup.exe的实际路径)选中后右键管理员权限运行；

2、启动Chrome等浏览器打开网页 http://local.zorrosoft.com 进行测试(安全网站请打开 https://local.zorrosoft.com ，HTTPS网站请把连接的通讯协议 ws: 改为 wss: 再执行)；

3、测试连接牛插系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3就表示输出日志同时进行Gzip压缩。
请求连接牛插主服务：ws://wrl.zorrosoft.com?sid=123flag=1 点击连接按钮会输出连接结果；

连接牛插主服务后支持的功能协议：
1)、获取牛插中间件版本信息：
举例：{"req":"Wrl_Version","rid":1,"para":""}
说明：连接主服务后可执行，返回当前牛插版本、当前电脑版本、唯一标识等；

2) {"req":"Wrl_Restart","rid":2,"para":{"TK":"8EE0F6A89E301225DDD556DAEE460111F59EA39EB08EC5DC985725C33AFEACAB7076097D786164208D501EDD95F1CBDCADF174B6B005ECFB852BF6502A8CCAD1A8EC8C43A02DDF0B8932C4AB9F4D9E87F98ADAEA09AB5C4048FDDF4CF1E827CB4348B749470EE671E1B49251BFD6FCD4B490B7F828F3844C2EBED529588C90482A0E6E07E21137986153E9E0AECE68F3D61FC1F21639D97E11A0B94B3F5B2B23F16C40A6B17568B6BD2716AB7323D34BBC941CD80A833527320AA79E2F79A57659AADB7AB7B26D28593B6F415C1EF0EE033B35B3D723F98BECF0C334BB8C05DFF81104F84F2514D0E878BC8936D1962504939618EE43474438E5AC72E1E998D2"}} 请求重启牛插主服务，需要验证TK信息，TK由打包工具生成，24小时内有效。

3) {"req":"Wrl_Remove","rid":3,"para":{"TK":"630035EFB20C2E5433722C36BCBD2F11A5658041E0782837C9E7D9417186A20E8079EF9E70D536E47FC14AA9FE8E5726B7F4E5EB685AED4DC5C0D519ACE64BA2037D0569FFCDCA8AE31718D9B193C049581077898C6B7A3A8467EED0D44A7F02390E22AADBB82C8907EB3E4E1ACAC056A7C35A8444497B7A2E742627C084D99A5EB98AEB5164B237584B6DAAED75D64FBB5A1DEC8A832CCDCC589EA94012BF55B4AA327B7B09E72106A52281D2C6030CD3B3C4621C20270B33FA9B6738ED5042410ED94B3148B835BA19619438422B00EF2F4B3944142751D7F94A477C33FB42170CE337F09D80AA0021110CA70F588959BD2ED4F9240CB07E3A456D29945B52"}} 请求卸载牛插中间件，需要验证TK信息，TK由打包工具生成，24小时内有效。

4)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":2,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息；

5)、判断插件是否已存在
举例：{"req":"Plugin_Exist","rid":3,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

6)、安装插件
请在输入框中，分别输入如下请求，然后点击发送，完成三个范例插件的安装：

{"req":"Plugin_Install","rid":1,"para":{"Name":"Dll无界面插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-04-01","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"F67DE66F7BE92CF8839BB405C1468BA2","Version":"1.0.2.2","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"49EE2AFBED8FAB4C062C302FEAB3B72E7EC0978BBBE6A956EAFA4DEE7525ABA59E7C27C494D162926D3FD0497C26F66BDCA4C0DA88F65A822BEE9FC8D752D03FC027D54059F46AD3AFCBA65594AE1A398035C480DE1CBBE1365D92FD16DC1355C2C6BB340D2BAB16F1101CB856911719054FB19BEB04DFB3EEA1DC33E7C162D00B48B32707C59E2D603B35F5F771791AE3838FFB6FACF1FED91B3A582283836EA0649E6967B8230E0ABAFE4951B2F4DAF259D9612418AD8226AC880F6D7EF15FA180D6CCFDECA6110486E9AC0D2C43E34B0F289FFE02AE739A88F674D256EA71964E0A6B86D87CB759C24D32E51B014C572844BC563B2FD83FCD1922D2FCB5C6"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#无界面插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-04-25","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll.pid","MD5":"3556211A707A25911B15ED581C021703","Version":"1.0.1.1","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"22261540F43350071F57C516F82EA373028683924FA84DCE7B8414F80605EA3E66343E22E394049BC241E0DF18AFB7D41C4A916F2FCB3363FFD4F6CAA179C710BB6C42C369C454F2B6610AAFCB634D6CF9A26EDDA979CB8F1C0C75E31D5B54AB2A72E501B9E4242FC825CB8701995D7ED0FE3AC0B9ECFD02C29801478625004C6164F9A6568C21B1B763665AE09FD3DE6F9D90B43A0856C3D127AFB01B65970C0F957B767EFCCEB1DE28EEA077348F36ED5CEA31CF213B702B5530DDADAD4BE7C902B6F1BF7ED4495C7442A87BDDE47918162D0087C5EF85221000F95F033FE433FB7769E0CAB3AA21AEBDC919BE53DCC064CFD6E733C25DF2E9B9C93EE1820F"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"c++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-04-01","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"2A029EC73E9A7C683C813D99DC6BCE6A","Version":"1.0.2.2","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"3E8B31C7BFD97C61C6A34ECF10076F6444FF5A5036E722C4F3BE217CDF83952EE24446CF51FC86242A5FF09DAAF55A88EE7584F47C40C67E1B3FFBD10BC4E9CCBE7BDCB2F6F29588DA1E8FE83409627A189555897E3E9D734C8DF149A412CB466F616F5712E5359EAF2AA264BDE95A4FFE8A1D4AB99BEC160803F0C8E958EE9DA760A24DA9DFBC31BF7BA46BAF1AFD4E3E285DD967784179F1EEB20160BE355407786F2000A0A4379F1D2E9D333DBFF7297014837C0DDC46BABD0D01F53C5881D5CA7D9DB8F2BB80A150ABC7D265C67F014CC802DE36FFB8D610AF77C9BA79143026C58829990E1868A322E9F5E9BB0022075DFF95D7C3A884F8C5511FD94398"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"c#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-04-01","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"E8C2E9D2A2FFF4E032E4567568644AFF","Version":"1.0.2.2","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"67CE5A14709F7901D057F84DBA585D753D9E12F1DDF91263567007C9DEA97D88905FB59A2C1B43906CAB7D618B01CD754189871D7673E1CCE63F2CAA49A54AFAACAC2DC6D7478D83DF8F9550B76560778309FB9C85E06AE92AEEEECE70CFD1CBB583FC14F6FB89BFDD51336E3CCEB94FC4D4E5B8C393F42445AE9E515DF1236FEEE1E830A4E9F348D9609D2624731F1BF460BE5FD7A2AAD161F98651FC9CDA10949A016316E005683430D6657084DFC3621B61DB07DFA5C350C066A5DE376429BDCC1FF646922933C79E00B9B5411C44F81989E8C6F9D32040402B75719E5C7F18D32E1D5576408842BAE21ED69C914A758A61200A774A49E9B9F93EBB8AE2F3"}}

7)、插件升级：
举例：

{"req":"Plugin_Update","rid":1,"para":{"Name":"Dll无界面插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-04-01","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"EEB30432E50F6C4719372D59357486FF","Version":"1.0.2.2","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"6F03C1AA1B38CD80F4C05D32B901A20A33377E5518FB98386C02DB1006214A78A72F7CA4FF2E2BF72E068DB9E7E1ABF51329820C3D7064414B031C9C53F21FA61D74D87B1E8F76C7E4D4A92235555281052AA4E32E64ED5A3774FB30256B31DC44EE2CC49DAC366784B545C7836FA12B9E2CBD6A992C38B89816528A5971F9ED8A46A9778353858BBB101D655169C612DA29AE73B75D9F950E7BA80E27D84723EAB7CFB1047DDA4F54B4FD2E8B3213D91B401FC52439353D19492A28D56936718BF27A5546010C7655A2CB71F7FDBE3034A1BCCC2CB9C6F454988450E9F526B1FB65481E177E77631CD3F115DBC8FD7D84628D3DF81837149111F0DBD15809CC"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#无界面插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-04-25","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll_Update.pid","MD5":"2820394EAB111437732CD73B6E6E91A8","Version":"1.0.1.1","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"5AA3D01022CCF8A319BFE8C0386F707FC78EB7A44280EDA04F8C9F2AEA981FA8DF28C903A83CE306C75429BA82168E4A4B10C8893FDD48773524C4DF17BF42F1D0E00441209C6287492CCC0299B83148C7268EDF805B87B0FD76DB1B356A5AB433899CC6F4070DA6F7381DE4028AD02642BD228952C3BBBEAF864FFC2F55E52CF9FC99DD8BF08E183B392B97D29303677154CAF9358824245C7C50C6FEFBCE508DFC3EAD4E18F07FFFC718E1CFBBB8D4B7E387489920E7A8A6B5D931321DA4588FB07E6CD6330AD4B8FCE3D3B0FAF58F935FCDFF92069ED59D432BF94464DABE0CD627431A577D1D3AB01E398A036224F321FBBDD347DF38B46B6D4530D442D7"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"c++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-04-01","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"01B216FD618BE72EB5FFD8F81A51D187","Version":"1.0.2.2","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"A3A8DFEAF9C2DBB8017C8B29F4656B9C7457E3EC89D107B59EFF10DE15471027B8DBC83D60F1B5B35DFCC1D15B3E6922EF17ACF200A08F4EFCBE1745140E531358EFFA574511E366134169F9B07DF3F3B0657A09024DFCA8A53D57D8C6B90FA3580368617AAD48BE835611EC04ADE369571B63625CACB70EDF3D63B146BB52394CFD1087E89AE472171450383F8CEBD513D96A92C4A2A8ABD89B716D2F12057840DCB221050CA9A18F918EDBEFAEEBDD0721936DEB5E93D069558C0263CF964A8EBF3326065B77D5BA16DFFBE4438EBBF2A41BED5452B5ABABAD67BE1FCE7F8AD8434D09B3A0C602BACF03FD940A9C9E121A34D951EC60E97A0C1C52297024EE"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"c#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-04-01","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"6C7BA3EAE6293CD063AABE63DD1D31C7","Version":"1.0.2.2","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"A4B193DACADEE9BF2CEDACD518C2F753E42721F76150BAC043577CFB12C462AA30262D973B270CADF79D9103A9D37F77A0131911B29D4490AB46B29EBE9CF7A3F26ECBD23BD9CF38713373425DA57372E29C242F745854E4F821E78866BBF790A55A785C44F4948FFDEA03123B6A6638BD3FDF57A74069F569BABDBC02DBD4ED8DAEA9E0389052A59F1E3FC936BB130CDB389CF1298332695905A3682EC174592EA2C2227ECCCB8ABE42F28CB2DFF83D3E45AE355DA40C03FA411407B2C3ED84BC98806CB52B7CD6769DEB73638FD114CCBEE94D72382BCB465B1FD05F4B6B812896CCCD5BC8014BB67F0832681FF0FD4EA3673932C8C2905DB9176E0BE82B33"}}

8)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":1,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"D10495F4-DF0F-44FA-8647-91275347214A","Type":1}}

4、牛插框架升级请求：

{"req":"Wrl_Update","rid":1,"para":{"Name":"牛插升级包","Date":"2019-04-28","Desc":"改进IE中使用的WEB SOCKET连接组件","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"A6C7E0AF450C42BF51D307E58C8B18AA","Version":"1.0.8.6","Size":2818048,"Cookie":"","Auth":"","TK":"47A5180445E94721922A16087D82155B4FDD99DABB70A682E1A0775AC8D926D84D4CFA7471EF74C0A9717CF2306F7338C3F07BB989D1F47DAF98C029EB1BC084CDE10D4AA472A08FA9B148C13A164C259D2DC46C0C7380952D949DC00966AD9C8B7153EFFD442F9BD9634ABBEA5026D624962260103BC7A4C81A739577CF4D171502248D328509F2700D6FFB22BA6E1D50FD3CC50EC86220082140D8FF8E8324392E7A78A05425E73AACB92542C04A32794DD8C1CB816E28A7B661C82A5A587067E2C73E774F26AFFA0877AF71E54199BB01918D017AA63F5FA81E310E7A17A173D6B53A1529F03C2E088F59E4F522DD892AB039D2C51E43F02A97E4379602DA"}}

5、连接请求指定有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

6、连接请求指定无界面的插件(c++ dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1 连接请求指定
pid的服务； 
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":2,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":2,"para":{"Name" : "牛插文件插件.txt"}}

7、连接请求指定无界面的插件(c# dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=8756&pid=FCADA8A7-D975-42c6-B5D3-FA40F6FE1286&flag=1 连接请求指定
pid的服务；
2)、发送请求：{"req":"Demo_Return","rid":2,"para":{"Content" : "测试回复内容！"}}


请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请咨询QQ客服188872589。
