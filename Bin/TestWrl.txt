牛插中间件-浏览器插件开发通用框架测试：

1、解压牛插程序包到实际的磁盘目录，找到批处理文件InstallWrl.bat(执行前先编辑写入安装文件WrlSetup.exe的实际路径)选中后右键管理员权限运行；

2、启动Chrome等浏览器打开网页 http://local.zorrosoft.com 进行测试(安全网站请打开 https://local.zorrosoft.com ，HTTPS网站请把连接的通讯协议 ws: 改为 wss: 再执行)；

3、测试连接牛插系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3就表示输出日志同时进行Gzip压缩。
请求连接牛插主服务：ws://wrl.zorrosoft.com?sid=123flag=1 点击连接按钮会输出连接结果；

连接牛插主服务后支持的功能协议：
1)、获取牛插中间件版本信息：
举例：{"req":"Wrl_Version","rid":1,"para":""}
说明：连接主服务后可执行，返回当前牛插版本、当前电脑版本、唯一标识等；

2)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":2,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息；

3)、判断插件是否已存在
举例：{"req":"Plugin_Exist","rid":3,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

4)、安装插件
请在输入框中，分别输入如下请求，然后点击发送，完成三个范例插件的安装：

{"req":"Plugin_Install","rid":1,"para":{"Name":"Dll无界面插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-03-21","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"55283CCDBA3F2B278D93BF0907421BC2","Version":"1.0.2.1","Size":524288,"Type":1,"TK":"89070DAF1CF1BF09FBB0033CE1A6A954ABB9DD557BEF4571D67692E355091A134D726124C1D96428B1A4B6CEEF06CE8E54722C09221B60C1AED7F6A5B846C724D03A605FEF743C23C4461467935EAC8AB9571F1187E899E49733C80D9F8DB975405E03C484F323D93E0122ED885D4FB458F94F1102B954B1843E2DF3A3E993BF935967BB8E26220A8436AD034A9528003C7AE621D78DA4CBA54271C0FAF6A4F94F128C9E576C970EECCFCDC5740D359EF3C74A74FF52BAD656B4C4E32BD9B7E6BE520782480E4BC1BA9349890361DF9EF3A7C7CE7BF5A87E993D6C61932606349DC2F8A6D270F39A66A4B10D7A675A8BA74FF0A084F73D314100D0A417CEBD73"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"c++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-03-21","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"7AC1F5A3DD08FC22C7023B9DE326BB1F","Version":"1.0.2.1","Size":622592,"Type":2,"TK":"B947D016B0E600F519EBC2C54CDDF4FEC27269E6E7D7F963FC40B95F32669F2B03CAF79D76AEC2396F1E67D968A8847D1B3D393F0043B0C3684E7F429D686CB55F0C7D16546EA3D38A253ED6F62B09F9AF347FB9342A46D046AF719263F835BB6A7F8284F09D4BE8D260F82CD89A68038D15DDAE2E335207AE0B1A4AA78131DBDF70ACECDA1672A5D7A72DF9CCCA93A18F146DCC9389FE5CDD7B518F88578A483257E3E645859213507ED7897F819787E0398EAB93C96D16ECABF867A734C244B664E1FE513DB355DFEACD18EAF84A2AFB6CA7182C7A4601B608476EF4D60C9A3CD04899294245653DE1C73C6FC82F308A7FC616BE13271CB0FEB3B4DF22158E"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"c#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-03-21","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"5647F09F64D106611FA9EE9343ABE9D9","Version":"1.0.2.1","Size":524288,"Type":2,"TK":"60C2158419A5A7CBADE3DC45BDE1F2E230D30DC122BB772CAE62BE3FF280639AA09DC955BA12285754DDBC1E7A8762A91250DD132E930E26373B62764ED2956DD3DC1E22D64EE9305ABDD11A05BAFFB4A5AB5D5EF1D2557FC78021C08615088FF2DD3AB796D9EBC161DFF784FFE8D236E04EFAAD02440BA9CD83430373DE52953B8C5E97E270B5EBFAF7B12AB7AC1A051185EDCD1A3E1C8372C547665F14983E110CC7D7B173599AA43355A9A7794628640DC87F0CE8EE4E0EEE531BDAC20AB6215BE4DAC1820F0EB4FEB3A8AA03A8649A375B03930A268A92E9499C91F4D13C969A1A4ACBD99DA806954BD99E3D391A06C1D8080B2CE219CDBD369A2F6C4AB5"}}

5)、插件升级：
举例：

{"req":"Plugin_Update","rid":1,"para":{"Name":"Dll无界面插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-03-21","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"537A36FD6EE7CF639333C7BE5C7D2A28","Version":"1.0.2.1","Size":524288,"Type":1,"TK":"32FE92D371DC7F1294DABBC87A74C51D51B1A6A94A95BA641D977BE2AD98614F8A499748CE353E20282A4007733F3970E9FF7E5F57A2F8FDBC69598A750DDEBFAABC168B92B73D308DDE9A313286BB32221D598436626632E3A435E62C74D24B03E051DA274813A20A372564C5625E0289D1E0B7020FBC4BCF59D33616F1C0262374DA3981A7BAE63AF481FD6CDFBA35C20FD482480AAF4D6C4B58CDE9C430B231E616510120D8F7A994A95FB6F9B03BCAF779D3B9292C1F35B0D77D9F76057E9DEB981EB067B446B6810651E7A0F754E78C9A6CF867E1C28921589E4A55B27E9A595A4887D3E601E12FB1900F5826EA08B70D2C737A48FB5FBE0233B6420CAA"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"c++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-03-21","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"92BAC4ABC90BDB6E7701AB7C83F56B8F","Version":"1.0.2.1","Size":622592,"Type":2,"TK":"0D0BA03857B6385829A143DF010865FA3949B147B09F77BF66061C89D03D0F85621B518FEA10F22E7856B2402C955F978C2088E57B03261D4D4CD866C1C401D13A68F8A18F45D00548576D0105D66249CBA273A8E54ACBDD15CFED11A8A2C8D9756491D739428BA3908768B9B3B4969AD8C2147B9FBAD151DEFEC65CC0BF7A1B67371CFA76FDFA10B2903975F7CE7FBE1963C80627AFCAF1C9E27C684555B0ED4A19523FD3422B6DB9D08BC2858D23F2713B4D119FFFCF78E30549AA064C74DA1D1F84CBA1B37E4DC29B55C27D6D576B7CD8FD3333365C745166546BDC01122437651E4A39D89FCA71F67F70C96A9865AE7EFB540FB2965F9C09A65B1EB07607"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"c#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-03-21","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"1724D61A6D3B549796FD448A86F5D5E2","Version":"1.0.2.1","Size":524288,"Type":2,"TK":"09AD482D40BF0539160E3C8ECC4EA2504800527B2DBBD8AC021F4E9561C15B7748B5D839593CBDCACE0E59B7F088E96F1836EF1DD9A6C2337B647CA7E322FEC92CE34484686D013A42A322FB2DA274B6CB47171DF9359DA9423283E9A17549FB93839C1A1EAF53E79E05622B4FB8E131D82AC76759A61A75115920052307EA54F9F077F847B72D771FC7539FC08FAF63F7AF9D4018E7370AB8BCD548DFE528EA4B776FD4E1A1980EF2B0674D4D358690DA0EF15B837C52EC7BB8729039B3291F9C68EA392249C0226C183005F34F99C5532ED293149D5067A5EAC20FBC34CCDFC32D3B95EA68628E4E292014CF7AA16C7C3F039447D569B675FFF40CF7D468D3"}}

6)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":1,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}


4、连接请求指定有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

5、连接请求指定无界面的插件(dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1连接请求指定
pid的服务；
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":2,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":2,"para":{"Name" : "牛插文件插件.txt"}}

请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请咨询QQ客服188872589。
