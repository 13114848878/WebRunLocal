牛插(PluginOK)中间件-跨浏览器插件开发通用框架测试：

1、解压Wrl.zip程序包到实际的某个空的磁盘目录(切记别解压到磁盘根目录，避免卸载时删除了无关文件)，找到批处理文件InstallWrl.bat选中后右键管理员权限运行；

2、启动Chrome等浏览器打开网页 http://local.zorrosoft.com 进行测试(安全网站请打开 https://local.zorrosoft.com ，HTTPS网站请把连接的通讯协议 ws: 改为 wss: 再执行)；

3、测试连接牛插(PluginOK)系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3代表1+2，4用管理员权限启动(仅限于启动exe插件可用)。
请求连接牛插(PluginOK)主服务：ws://wrl.zorrosoft.com?sid=123&flag=1 点击连接按钮会输出连接结果；

连接牛插(PluginOK)主服务后支持的功能协议：

1)、获取牛插(PluginOK)中间件版本信息，Mac为1时获取本机Mac地址信息，More取更多信息(当前登录用户、键盘和鼠标空闲时间、当前电脑制造商及型号等)：
说明：连接主服务后可执行，返回当前软件版本、当前系统版本、唯一标识、授权有效期、授权客户名称、当前系统启动后运行时间、程序运行路径等；
举例：{"req":"Wrl_Version","rid":1,"para":{"Mac" : 1,"More" : 1}}
返回：{"ret":0,"rid":1,"data":{"Version":"1.1.1.2","Lang":"CHS","ValidDay":"2020-03-31","AuthName":"成都佐罗软件","Type":8,"OS":"6.2.9200.2","Win64":1,"UniID":"AF4D1A1623D03399E3E2F63449CF9B18","Time":9182568,"TickCount":163797640,"RunPath":"W:/WRL/","Mac":[{"Card":"Qualcomm QCA9377 802.11ac Wireless Adapter","Mac":"AC:6C:68:89:EC:9B"}],"More":{"ComputerName":"hello","Manufacturer":"Dell Inc.","ProductName":" 3580","LoginUser":"test"}}}

2)、请求更新框架授权：
分别指定授权文件在服务器上的地址及文件MD5校验码、文件大小和下载验证权限Auth及Cookie，其中Cookie和Auth可为空，根据自己网站情况设置。
举例：
{"req":"Wrl_UpdateAuth","rid":2,"para":{"Url" : "http://local.zorrosoft.com/Files/Update/wrlauth.pid","MD5":"8BBCD7EAD95EFC034B724C4D8A961C03","Size":262144,"Cookie" : "","Auth" : ""}}
说明：连接主服务后可执行，可下载Url指定的授权文件并更新到本地；

3)、指定浏览器打开指定Url：
分别指定浏览器类型Type(1代表IE 2代表Chrome 4代表Firefox 8代表Opera 16代表Edge 32代表360浏览器)和Url参数；Flag意义：IE指定浏览器版本，Chrome浏览器0代表标签页打开，1代表新窗口打开；Show显示窗口类型，默认1正常显示，2最小化显示 3最大化显示。暂时只支持IE和Chrome。
此功能主要用于强制IE打开指定网页，Chrome命令行加载PPAPI插件等使用；
举例1：
强制用IE9兼容模式内核浏览器打开 http://www.zorrosoft.com 9999是IE9标准模式
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"1","Url": "http://www.zorrosoft.com","Flag":"9000"}}
举例2：
Chrome浏览器新窗口打开http://www.zorrosoft.com Flag为1新窗口打开，否则是新标签打开
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"2","Url": "http://www.zorrosoft.com","Flag":"1"}}
举例3：
重启Chrome命令行加载PPAPI插件，插件路径如有空格的情况，空格要用%20代替，路径单斜杠用双斜杠
{"req":"Wrl_OpenUrl","rid":3,"para":{"Type":"2","Url": "--register-pepper-plugins=\"C:\\Program%20Files%20(x86)\\ChromePlugin\\ChromePlugin.dll;application/my-plugin\" --disable-infobars --disable-hang-monitor --flag-switches-begin --enable-nacl --ignore-gpu-blacklist --flag-switches-end http://www.zorrosoft.com"}}

4)、请求使用关联程序打开指定文件：
指定本地文件全路径，使用本地电脑默认关联的程序打开，路径用反斜杠或双斜杠。
为安全起见，这些扩展名文件不支持：*.exe *.msi *.js *.jar *.inf *.com *.bat *.vbs *.py
举例：
{"req":"Wrl_OpenFile","rid":4,"para":{"File" : "E:/WRL/Ver/TestWrl.txt"}}
说明：连接主服务后可执行；

5)、请求重新注册中间件组件或插件：
如制定PID代表重新注册制定插件，否则执行重新执行中间件安装批处理(连接会断开)，可能因为一些工具或手工误删除了注册表等，用于修复软件功能。
举例：
{"req":"Wrl_RegCom","rid":5,"para":{"PID" : "A22E18F1-95F8-4FDB-99D2-188E5FB12B23"}}
说明：连接主服务后可执行；

6)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":6,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息，Detail为1时返回插件程序全路径；

7)、判断某个插件是否已存在
举例：{"req":"Plugin_Exist","rid":7,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

8)、请求重新加载指定插件
使用场景：不用重启服务即可扫描新增插件使用；或插件调试时，程序及配置更新需要重新加载时
举例：{"req":"Plugin_Refresh","rid":8,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

9)、安装范例插件
请在输入框中，分别输入如下请求，然后点击发送，完成四个范例插件的安装：

{"req":"Plugin_Install","rid":1,"para":{"Name":"DLL版COM插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2020-03-03","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"95ED3EFB0F24F1119B2D6AE6C6926DA0","Version":"1.0.3.5","Size":524288,"HideIns":0,"Type":1,"Cookie":"","Auth":"","TK":"1D2E218C2123C5BDA7C41C0A4873BAB3705F7421B92DEEDDCCDBFBE1BD6A64A82CEF898AAD52811BEB35CBB989E4C2B7AFE62BEC0D507436A37DC28B00392D4BE178EF53E951C37C7FDBDB5DDB343AD83C44179B108469BA02AD5EA35EA2D019CB0830680DB52B0E3AF0C9724F5EB0751562A406A021428CAEC83C87F6A9DB31EBA861CCA08EA216F8724BD4BCC7BCFFD227A6AC0F41570FBAAA261F1575D24827184DB0148596BCDCE40632D63C82CB82487E2B070941D093268C302AC376F7EB0DB6A80ACE35ED47EFF4A9372B7045A6345B0DD8A7FB0691055F17C8325E51FDD2B8C21E1118557ABDA439CED8391C7BEDC0ECA5AA9E9CBF5CF14D032D2E6F"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C++程序插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2020-03-03","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"CBBCEA01C951EF1D7EE11FDF77938491","Version":"1.0.3.5","Size":589824,"HideIns":0,"Type":2,"Cookie":"","Auth":"","TK":"2F5DA15D6D72581DA44279758A1D4DF15AE748572B062F9C639AB96A97039CF7074D568D5CD221FDF778F3A6E474366683B975BD7C25861942282FD80FFD725ECD4CA30C26CEF375A7E3438C86DD2FD36441C589304F4DF9D0ED1E24388872DFE106B56BC6F2555E460698197D41A245351EE9AD1BFDB8BF8B00784DC3EAEBE8DE195666975054C500CE6DEBF25128010214D032AF577BD9E3C578644C22D040D5E32CF716DF24132E05286587BFDAB44F759E23683ADA331E41140B2E940CC644D3FF93259E8D48F89195C7E729A1B714D655B989923DAEFE44258BB01DD2F26F3AC67AD736FAF05D851F659DA2628A03BB4804B2847517CCC398412B2FBAD4"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#语言无界面插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2020-03-03","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll.pid","MD5":"CE887F2F5555F08BB24D3FA8AEA22078","Version":"1.0.3.7","Size":393216,"HideIns":0,"Type":1,"Cookie":"","Auth":"","TK":"14209726CA71160C8DF2C58541F30C6F254BF1077B8DFF3E9A097F53AF739BC6AD332BDE9DC231058878A86F6BE7198119C4E46202D043528FC291B165FF9B7021A4DBA3CA93E5B6A76D14EC2EEF5F417A9E5A174EDE46FC6260AE70E11F954EC05EDC0C0E7BD34186AA1D2C713C6219375B01CE8C8A688819A2C8FF32AA7D52C14647E7DE503F5B468A86E71E94B894441897353293EF45B360D6D560E22EC71723C0DFF150DF87ECF84B9E6303980FD1226F0E24A7A8ACA309065BB2DF7DB7F4BDC0C17E54A604E2353515D304F9A61C13B56EF2278BA406B097D4227A7EA79E3506B1030EF625D8C9FB88219044B8887BBBEF4325FD31DA6674CF4F4C12E8"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#程序插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2020-03-03","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"1E37346CCFA19BFBB056035E50B8DC53","Version":"1.0.3.5","Size":557056,"HideIns":0,"Type":2,"Cookie":"","Auth":"","TK":"5ABF218FFAED4D1FAAFFE90D04F9A93C87DBBC85221EE48124A1C0EFE2549A7FF8B2AD8960F34504374D409BD6351B051BC33BD63C8AE8809707DC3770058A234B7B317B02723C1CF57E6CF67043AFAE15DAD211D20943AA7E5E0D953F8463531B7F05CFC38D70E2D9610FF57DA523E61CC2972F42500C7A29951F3B74FD442C70363B21201DA202CF64BF5A5D22DB7BB9B64ACD82444FEAED680485C0F8556CA83EDEB2D532F16EA192BE1907C8EA200EBB6DB708D71F7ABF35B1797CD4AB0B3BBC738BEA6FC7E8CCBA74FA90DAECB192F4B4877AD9D8D85FE571E514A233DDEE1B8FF20DEBFDBAFE1C06AEA726317D2D13B9D2FBC04A29073236A6DB3218E3"}}

10)、范例插件升级请求：

{"req":"Plugin_Update","rid":1,"para":{"Name":"DLL版COM插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2020-03-03","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"AECCADD429D96FF009783669CDF83178","Version":"1.0.3.5","Size":524288,"HideIns":0,"Type":1,"Cookie":"","Auth":"","TK":"9E3E266D371A70B17EE16090153A430BC43C4819C277562E8CA88891F05293D98F289A2D6FFCD4531FA0D629C14CADBE3441E3D8BC8E3941C6A4FB273837145EB1102D4E6F404571B1217AED900A52454369681EA9D9BB95744B36891003BB42764DFB0EBE36EC5DD45E61E0C9774999DE327F36CF81443086503E9EE393A3C2EE4744F73DFD47CEA69E81DEB61AEDB322CE84007F4F7A25021C222F081D20E6FF63B74C1BC873A248DFC0C64D4DC9B775C8D87BD2F2E9C9884E93E58B7209C35E5E5F082D91CD23CCAADCF928CFF82A2A124763B4192693369B107C5B83373588361D90ACD591BBE073B1EED5D1BD685634FC60F947F32AD96BC2A7A4B57FAB"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C++程序插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2020-03-03","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"4334C5E4B9F15CB749A0F0E7BB89D946","Version":"1.0.3.5","Size":589824,"HideIns":0,"Type":2,"Cookie":"","Auth":"","TK":"0707DBC5CABE611CA1BB3B62C97D446C378D015C5C6443FBC09298B4126827813294D5F6DECB307E29982571276DBA427ED34709DB3BD67D1614CB79E4CEF18C5EA1A82FF3EF375013C5849473525B16066D9E04B20ED13FB2E39FD83C8B9E90A2DB512EDB13587A843DBABDF5C97275D4E52A6E923BE8F7D118B94677E9BB1397CE8558621D2DFF75C70BFEC94545B258AAE730A9F35D95C341283FC88B9F59CD5084EEF7B00489CDAA66A55A02D646C749254D0C62BB8F9453B47F52F69286FC8A1CF21BADA2557D97EC3A3324D1588C555DE8DE1AF7188C162F9878529B74BC0CE2BD5EE14AF1834C5861AB865F855620659C232A925A2660EAD1DEE52021"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#语言无界面插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2020-03-03","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll_Update.pid","MD5":"AD547B11FCC55ED4B215E6635CF3AFD3","Version":"1.0.3.7","Size":393216,"HideIns":0,"Type":1,"Cookie":"","Auth":"","TK":"090C32DD92CBB88BCF311F46CB3D05964DB69F7A0EC2BE60640BB45F40ED8E97FBCCED3B3A7D009BF684F9602A977F16E09425E1C45F2F3DD31282953337D4C39E4334F04CB6E21CA616C0953326C4AFCDBB91D1F6B7C01B5704083191D38FC8313F2E346D8072A33AF560A712C93E937748DA9C14F31C6749071094BF73D5A5B4D7AEF6DBAA4634B18DCFD11C3DC064893F70335B4E44C784F8680EE0C40B456603AE893C26867C048AD93AB5046E7C8347055207529B09D2A59F90961017DA3558A87315F9E612D72453C459CBF8B5D72D73DF5D546F997F9C446B35606F1CA0D6850196B3314082C810EB4028D49F2C847664FC1C91301591776981DE8CC5"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#程序插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2020-03-03","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"DDBAA6BF683EC7E85CB7F10C0878EE42","Version":"1.0.3.5","Size":557056,"HideIns":0,"Type":2,"Cookie":"","Auth":"","TK":"096DADA951D7A23E15C1DA30DC278E2F98FDF5D8776C3BEBD95193272CDE8AB39A6102DE8C4F3A7EA1DC48AD6D5D55F990B6219D1247AC8505D7334E54764787B6268614464DDEB20F04BD0E76508CFCC57F43B4CF3E2C54F23927FB6E5155ADF8759C8E9AF6C40E32111868CACBAF2B49BAC61B2EDB2381DCE8FBBEBC1564B3D92DC3327A7E3621A0AD195FC591200BD48905F34DBB9BEC49A90FF23BCA5076AD94FAB37790ED829D21D0AD2328FEB14D1047874B373C16733675939D91AAAA2797449C25A62CD7687D7D1BDD4A9EEEA278E6469671F75ECB9A8F9F6F63FA40B31684F3CDE9CE07FF361D3A122B0EAE4848F3B2BAA5C51F54A84AD062161061"}}

11)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":20,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":21,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":22,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}
{"req":"Plugin_Remove","rid":23,"para":{"PID":"D10495F4-DF0F-44FA-8647-91275347214A","Type":1}}

4、牛插(PluginOK)框架升级请求：

{"req":"Wrl_Update","rid":1,"para":{"Name":"PluginOK升级包","Date":"2019-11-07","Desc":"1、实现关联打开本地文件协议Wrl_OpenFile，不支持exe、bat、msi、jar等可执行程序；2、解决启动exe插件时不返回侦听端口问题；3、解决协议Wrl_OpenUrl对XP兼容性问题；4、解决XP下获取电脑信息及当前登录用户错误问题","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"994569C75125B14675A721F6FBB0C27A","Version":"1.1.1.5","Size":2818048,"Cookie":"","Auth":"","TK":"2128A062CD3828E6D633BE14589ACDE4F6479B63A491C914FB98CDC41B67FCF152284A2399DC84E9D96BC4FB585B588E556615BA2FC58C2E1FB5C963A15CC2FAEFC56EEC960FD546D9124F734601582D9E219483C0404FBD8974014F1CCCD0313507F78BD0DB5681D521AB214B8582138EF3E78C4C66E3E76841E922ABBFD3197CB2035FF4BF707A68C231B58EF60846B9BA2B10E111E31BA2150224077BE97228D7027899192C1CB0CE41A4825FEC9241944C8EDCBF8EEDFA10DF3705820B8ACC26F819A4BE8E165998BF79A2E1151F612B0991FC4DF445F899DEBE26E2F9DF075BAB1237B0D5797D25907482FE766456671B70547CF63BE5C480224B6416B0"}}

5、请求启动C++有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

6、请求启动无界面的插件(dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1连接请求指定pid的服务；
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":20,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":21,"para":{"Name" : "牛插文件插件.txt"}}

7、请求启动C#无界面的插件(dll)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=FCADA8A7-D975-42c6-B5D3-FA40F6FE1286&flag=1
其它步骤参考C++无界面的dll插件。

8、请求启动C#有界面的插件(exe)服务，连接地址：ws://wrl.zorrosoft.com?sid=666&pid=99225C6D-B7A3-441c-AEFB-3EE23ACA2209&flag=1
其它步骤参考C++有界面的exe插件。

请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请联系QQ客服：94074441 或微信客服：ZorroSoft
