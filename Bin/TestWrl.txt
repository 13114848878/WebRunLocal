牛插(PluginOK)中间件-跨浏览器的插件开发通用框架测试步骤：

1、解压程序包Wrl.zip到实际的磁盘目录，找到文件InstallWrl.bat选中后右键管理员权限运行；

2、启动Chrome等浏览器打开 http://local.zorrosoft.com 进行测试，连接的通讯协议是ws(需要测试SSL证书的网站请打开 https://local.zorrosoft.com，通讯协议用wss)，点击连接，如果连接失败，请找到程序安装目录下data子目录WrlService.txt文件输出的日志，看是否本机已经占用了默认的端口；

3、测试连接牛插系统服务，下面是参数说明：
sid是唯一连接标识(插件服务支持同时多个连接，需要用唯一标识进行区分)
pid是连接插件的唯一标识(在插件配置文件PluginConfig.json中定义的PID值)，不传时表示连接主服务
flag是连接控制掩码，1指定输出调试日志，2指示通讯数据进行GZip压缩(网页JS需要进行同步处理)，3就表示输出日志同时进行Gzip压缩。
请求连接牛插主服务：ws://wrl.zorrosoft.com?sid=123flag=1 点击连接按钮会输出连接结果；

连接牛插主服务后支持的功能协议：
1)、获取牛插中间件版本信息：
举例：{"req":"Wrl_Version","rid":1,"para":""}
说明：连接主服务后可执行，返回当前牛插版本、当前电脑版本、唯一标识等；

2) {"req":"Wrl_Restart","rid":2,"para":{"TK":"8EE0F6A89E301225DDD556DAEE460111F59EA39EB08EC5DC985725C33AFEACAB7076097D786164208D501EDD95F1CBDCADF174B6B005ECFB852BF6502A8CCAD1A8EC8C43A02DDF0B8932C4AB9F4D9E87F98ADAEA09AB5C4048FDDF4CF1E827CB4348B749470EE671E1B49251BFD6FCD4B490B7F828F3844C2EBED529588C90482A0E6E07E21137986153E9E0AECE68F3D61FC1F21639D97E11A0B94B3F5B2B23F16C40A6B17568B6BD2716AB7323D34BBC941CD80A833527320AA79E2F79A57659AADB7AB7B26D28593B6F415C1EF0EE033B35B3D723F98BECF0C334BB8C05DFF81104F84F2514D0E878BC8936D1962504939618EE43474438E5AC72E1E998D2"}} 请求重启牛插主服务，需要验证TK信息，TK由打包工具生成，24小时内有效。

3) {"req":"Wrl_Remove","rid":3,"para":{"TK":"630035EFB20C2E5433722C36BCBD2F11A5658041E0782837C9E7D9417186A20E8079EF9E70D536E47FC14AA9FE8E5726B7F4E5EB685AED4DC5C0D519ACE64BA2037D0569FFCDCA8AE31718D9B193C049581077898C6B7A3A8467EED0D44A7F02390E22AADBB82C8907EB3E4E1ACAC056A7C35A8444497B7A2E742627C084D99A5EB98AEB5164B237584B6DAAED75D64FBB5A1DEC8A832CCDCC589EA94012BF55B4AA327B7B09E72106A52281D2C6030CD3B3C4621C20270B33FA9B6738ED5042410ED94B3148B835BA19619438422B00EF2F4B3944142751D7F94A477C33FB42170CE337F09D80AA0021110CA70F588959BD2ED4F9240CB07E3A456D29945B52"}} 请求卸载牛插中间件，需要验证TK信息，TK由打包工具生成，24小时内有效。

4)、列出已安装所有插件：
举例：{"req":"Plugin_List","rid":2,"para":{"Detail" : 0}}
说明：连接主服务后可执行，可获取当前已安装所有插件信息；

5)、判断插件是否已存在
举例：{"req":"Plugin_Exist","rid":3,"para":{"PID" : "F90B1CF0-8485-40ec-B4E8-B87598AAB35D"}}
说明：连接主服务后可执行，PID为插件唯一标识；

6)、安装插件
请在输入框中，分别输入如下请求，然后点击发送，完成三个范例插件的安装：

{"req":"Plugin_Install","rid":1,"para":{"Name":"Dll无界面插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-04-01","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll.pid","MD5":"F67DE66F7BE92CF8839BB405C1468BA2","Version":"1.0.2.2","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"49EE2AFBED8FAB4C062C302FEAB3B72E7EC0978BBBE6A956EAFA4DEE7525ABA59E7C27C494D162926D3FD0497C26F66BDCA4C0DA88F65A822BEE9FC8D752D03FC027D54059F46AD3AFCBA65594AE1A398035C480DE1CBBE1365D92FD16DC1355C2C6BB340D2BAB16F1101CB856911719054FB19BEB04DFB3EEA1DC33E7C162D00B48B32707C59E2D603B35F5F771791AE3838FFB6FACF1FED91B3A582283836EA0649E6967B8230E0ABAFE4951B2F4DAF259D9612418AD8226AC880F6D7EF15FA180D6CCFDECA6110486E9AC0D2C43E34B0F289FFE02AE739A88F674D256EA71964E0A6B86D87CB759C24D32E51B014C572844BC563B2FD83FCD1922D2FCB5C6"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"C#无界面插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-04-28","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll.pid","MD5":"2C235D8F7D0737244A17EF0088447CDB","Version":"1.0.1.2","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"81AD7439C15497EADE50F38971CF4F0BFF9359CF36A8DEA71C5642867EC98B9C5FEB09891CD94FEC93CDE9EF4273F560CE32E089152A68A899EB3691B003722E6589B525FCFE8508036AA425999B9EF16B930B2CAF17ACADCAAB2A94DF7A443C225F3C9AABDE9C7A818BFB210107318993EDB5EB044AA90FABF1422AA3E0F224EF79204A98E5B8E8F14F674277935516BF075BEE46DF25D5C769F010574FFF21D28FFC56E5EE8BB997C88E455DD14B6CCB85720D926535FB3C824CACD7D60B6ABCF70D74FCC8AEACC2ED159FEA800F442F16B71CCA83B681D19DF08DFA080D68E8837B76C6B2484926CC29F2A3E6BADDF70E9B7F24D6FE7BF19EFECD037917DF"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"c++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-04-01","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe.pid","MD5":"2A029EC73E9A7C683C813D99DC6BCE6A","Version":"1.0.2.2","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"3E8B31C7BFD97C61C6A34ECF10076F6444FF5A5036E722C4F3BE217CDF83952EE24446CF51FC86242A5FF09DAAF55A88EE7584F47C40C67E1B3FFBD10BC4E9CCBE7BDCB2F6F29588DA1E8FE83409627A189555897E3E9D734C8DF149A412CB466F616F5712E5359EAF2AA264BDE95A4FFE8A1D4AB99BEC160803F0C8E958EE9DA760A24DA9DFBC31BF7BA46BAF1AFD4E3E285DD967784179F1EEB20160BE355407786F2000A0A4379F1D2E9D333DBFF7297014837C0DDC46BABD0D01F53C5881D5CA7D9DB8F2BB80A150ABC7D265C67F014CC802DE36FFB8D610AF77C9BA79143026C58829990E1868A322E9F5E9BB0022075DFF95D7C3A884F8C5511FD94398"}}

{"req":"Plugin_Install","rid":1,"para":{"Name":"c#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-04-01","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo.pid","MD5":"E8C2E9D2A2FFF4E032E4567568644AFF","Version":"1.0.2.2","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"67CE5A14709F7901D057F84DBA585D753D9E12F1DDF91263567007C9DEA97D88905FB59A2C1B43906CAB7D618B01CD754189871D7673E1CCE63F2CAA49A54AFAACAC2DC6D7478D83DF8F9550B76560778309FB9C85E06AE92AEEEECE70CFD1CBB583FC14F6FB89BFDD51336E3CCEB94FC4D4E5B8C393F42445AE9E515DF1236FEEE1E830A4E9F348D9609D2624731F1BF460BE5FD7A2AAD161F98651FC9CDA10949A016316E005683430D6657084DFC3621B61DB07DFA5C350C066A5DE376429BDCC1FF646922933C79E00B9B5411C44F81989E8C6F9D32040402B75719E5C7F18D32E1D5576408842BAE21ED69C914A758A61200A774A49E9B9F93EBB8AE2F3"}}

7)、插件升级：
举例：

{"req":"Plugin_Update","rid":1,"para":{"Name":"Dll无界面插件范例","PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Date":"2019-04-01","Desc":"牛插DLL版COM插件范例-读写TXT记事本及获取当前系统信息","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginComDll_Update.pid","MD5":"EEB30432E50F6C4719372D59357486FF","Version":"1.0.2.2","Size":524288,"Type":1,"Cookie":"","Auth":"","TK":"6F03C1AA1B38CD80F4C05D32B901A20A33377E5518FB98386C02DB1006214A78A72F7CA4FF2E2BF72E068DB9E7E1ABF51329820C3D7064414B031C9C53F21FA61D74D87B1E8F76C7E4D4A92235555281052AA4E32E64ED5A3774FB30256B31DC44EE2CC49DAC366784B545C7836FA12B9E2CBD6A992C38B89816528A5971F9ED8A46A9778353858BBB101D655169C612DA29AE73B75D9F950E7BA80E27D84723EAB7CFB1047DDA4F54B4FD2E8B3213D91B401FC52439353D19492A28D56936718BF27A5546010C7655A2CB71F7FDBE3034A1BCCC2CB9C6F454988450E9F526B1FB65481E177E77631CD3F115DBC8FD7D84628D3DF81837149111F0DBD15809CC"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"C#无界面插件范例","PID":"D10495F4-DF0F-44FA-8647-91275347214A","Date":"2019-04-28","Desc":"C#开发的DLL版无界面插件范例","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginNetDll_Update.pid","MD5":"B6F55E3808328BE88F73A3AC76C9A52B","Version":"1.0.1.2","Size":393216,"Type":1,"Cookie":"","Auth":"","TK":"9C061AE4E1771A9F8B59BE4C76EAAB32047ABD47B5AEAFCAB07AE7097B2E1E0E1EA15AA685BA51621AD3EBC418F26F60B92499C2769294557049FA9D23A3E2AE9B0FCEB82103FD683E1764CACE990940D60F81017B2A63EAFF5002A33FB7AC7146371D526473C8AEFBBFE7B22E05CE689B25F6638D36AC24D495E5FA8E4B6C3A5EEE93C22413509D53B66746EC292E2720CE76423DDB5D46872D5DEC6D73AB9703E35D2150601B43249F055FA5848D18C3E3DC8F17CBE83775BAF8E71969B8310E42B4A6F9696E8A0820469DC0A76D55A59D7759724F80CA6609C0874EE47A401CDDC74ABE0F84BF69137B34EF3B7BD4EB9987BFABA1DB978656EAB67CCBE34E"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"c++有界面插件范例","PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Date":"2019-04-01","Desc":"牛插C++程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginWinExe_Update.pid","MD5":"01B216FD618BE72EB5FFD8F81A51D187","Version":"1.0.2.2","Size":622592,"Type":2,"Cookie":"","Auth":"","TK":"A3A8DFEAF9C2DBB8017C8B29F4656B9C7457E3EC89D107B59EFF10DE15471027B8DBC83D60F1B5B35DFCC1D15B3E6922EF17ACF200A08F4EFCBE1745140E531358EFFA574511E366134169F9B07DF3F3B0657A09024DFCA8A53D57D8C6B90FA3580368617AAD48BE835611EC04ADE369571B63625CACB70EDF3D63B146BB52394CFD1087E89AE472171450383F8CEBD513D96A92C4A2A8ABD89B716D2F12057840DCB221050CA9A18F918EDBEFAEEBDD0721936DEB5E93D069558C0263CF964A8EBF3326065B77D5BA16DFFBE4438EBBF2A41BED5452B5ABABAD67BE1FCE7F8AD8434D09B3A0C602BACF03FD940A9C9E121A34D951EC60E97A0C1C52297024EE"}}

{"req":"Plugin_Update","rid":1,"para":{"Name":"c#有界面插件范例","PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Date":"2019-04-01","Desc":"牛插Windows程序插件范例-演示脚本请求打开指定网站","DownAddr":"http://local.zorrosoft.com/Files/Plugin/PluginExeDemo_Update.pid","MD5":"6C7BA3EAE6293CD063AABE63DD1D31C7","Version":"1.0.2.2","Size":524288,"Type":2,"Cookie":"","Auth":"","TK":"A4B193DACADEE9BF2CEDACD518C2F753E42721F76150BAC043577CFB12C462AA30262D973B270CADF79D9103A9D37F77A0131911B29D4490AB46B29EBE9CF7A3F26ECBD23BD9CF38713373425DA57372E29C242F745854E4F821E78866BBF790A55A785C44F4948FFDEA03123B6A6638BD3FDF57A74069F569BABDBC02DBD4ED8DAEA9E0389052A59F1E3FC936BB130CDB389CF1298332695905A3682EC174592EA2C2227ECCCB8ABE42F28CB2DFF83D3E45AE355DA40C03FA411407B2C3ED84BC98806CB52B7CD6769DEB73638FD114CCBEE94D72382BCB465B1FD05F4B6B812896CCCD5BC8014BB67F0832681FF0FD4EA3673932C8C2905DB9176E0BE82B33"}}

8)、卸载插件：
举例：

{"req":"Plugin_Remove","rid":1,"para":{"PID":"99225C6D-B7A3-441c-AEFB-3EE23ACA2209","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"F90B1CF0-8485-40ec-B4E8-B87598AAB35D","Type":2}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"A22E18F1-95F8-4FDB-99D2-188E5FB12B23","Type":1}}
{"req":"Plugin_Remove","rid":1,"para":{"PID":"D10495F4-DF0F-44FA-8647-91275347214A","Type":1}}

4、牛插框架升级请求：
{"req":"Wrl_Update","rid":1,"para":{"Name":"PluginOK升级包升级包","Date":"2019-06-05","Desc":"安装程序添加静默安装支持；修复安装程序启动后没自动显示到前端问题；插件包中启动的一次性安装附加程序改为校验DM5是否启动","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"416D5795FA40BF1AC67ACE4FFD1AC62C","Version":"1.0.9.3","Size":2818048,"Cookie":"","Auth":"","TK":"0A5B3309324BF7D35E1B28A7BEC7FB5F328908F8257BABE33DB7B675E6497B2B075E02A15DF7BDE9A16E14DB54C4C960A61C2CEE7CC965C7243E949892CA4164CC70DD17F5504F2D544EAAEF8876212C91917034B4F468EB5C68976348B808221D00767A2ABC488327C8426206C68D1D795706F2D5F015ED65CB0B06ACC8446C3EF6E9D3C1E0CA8CEC4764491EC9B5156EDE284AA2DE441F35F30A569F32A8DFF44DC167556394A2CFADCE995D56F78531C5A6E3F2ACFDEDDAD5B99BDB1C7AD3735D5E279B72BE3D1C4D189B1424C8E9D9EAF18FF2761081ACE2BD72835B221C506E5AAA372EF43E3DEA12A0609E385BD18E149720065C7C39A4C9BCF7D1642B"}}

5、连接请求指定有界面的插件(exe)服务，下面以IE控件(ActiveX)演示调用流程及范例：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=321&pid=F90B1CF0-8485-40ec-B4E8-B87598AAB35D&flag=1，执行连接，会直接启动插件PluginWinExe.exe，界面会返回插件使用的端口，默认12800；
2)、再次打开一个测试网页，输入连接地址：ws://wrl.zorrosoft.com:12800?sid=888&flag=1 执行连接，插件会提示有新连接；
3)、请求打开指定网站：
在测试网页中输入内容：{"req":"Demo_OpenUrl","rid":1,"para":{"url" : "http://www.baidu.com"}} 然后点击发送，插件PluginWinExe.exe会自动打开指定的网页
4)、将连接pid替换为99225C6D-B7A3-441c-AEFB-3EE23ACA2209，可以测试C#版实现的类似插件功能，默认侦听端口是12900。

6、连接请求指定无界面的插件(c++ dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=666&pid=C38672FA-B5C8-4D9D-89B5-2D71F0760661&flag=1 连接请求指定
pid的服务； 
2)、发送框输入内容以下内容并发送，实现写入内容到我的文档目录记事本文件中：
{"req":"Demo_WriteFile","rid":2,"para":{"Name" : "牛插文件插件.txt","Content" : "这是测试写入的内容！"}}
3)、发送框输入内容以下内容并发送，实现写读取指定文件内容：
{"req":"Demo_ReadFile","rid":2,"para":{"Name" : "牛插文件插件.txt"}}

7、连接请求指定无界面的插件(c# dll)服务：
1)、打开测试网页，输入连接地址：ws://wrl.zorrosoft.com?sid=8756&pid=FCADA8A7-D975-42c6-B5D3-FA40F6FE1286&flag=1 连接请求指定
pid的服务；
2)、发送请求：{"req":"Demo_Return","rid":2,"para":{"Content" : "测试回复内容！"}}

请求参数的JSON数据包，请确保是UTF-8无签名的编码。如还有疑问，请咨询QQ客服188872589。
