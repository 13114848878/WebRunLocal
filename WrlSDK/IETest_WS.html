<!DOCTYPE html>
<html manifest="/websocket.appcache">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
    <title>牛插中间件是一个实现网页与本地程序之间进行双向调用的轻量级、强兼容、可扩展的浏览器通用插件开发框架</title>    
       
<link href="css/res.css" rel="stylesheet"/>
		
<script language ="javascript" type ="text/javascript" for="WrlWS" event="onopen()"> 
    alert("通知连接成功");
    var $WrlWS = document.getElementById("WrlWS");	
    $WrlWS.Send("{\"req\":\"Wrl_Version\",\"rid\":1,\"para\":\"\"}");	
</script>

<script language ="javascript" type ="text/javascript" for="WrlWS" event="onclose(param1,param2,param3)"> 
    alert("通知连接关闭");		
    alert(param2);		
</script>

<script language ="javascript" type ="text/javascript" for="WrlWS" event="onmessage(param)">
    alert(param);
    // var $WrlWS = document.getElementById("WrlWS");	
    // $WrlWS.Close(0,"测试关闭原因");		
</script>

<script language ="javascript" type ="text/javascript" for="WrlWS" event="onerror(param)"> 
    alert(param);		
</script>

<script language="javascript" type="text/javascript">		    
function testwrl()
{					
    var $WrlWS = document.getElementById("WrlWS");
    if($WrlWS)
    {
        $WrlWS.EnableLog = true;
        if($WrlWS.ReadyState > 1)
        {
        	var url = document.getElementById("inp_url").value;
            // 还未连接
    	    $WrlWS.Connect(url);
        }
    }
}
</script>
</head>

<body>
<object ID="WrlWS" CLASSID="CLSID:C0971B90-4513-4E2D-A0B6-15B915FE748A"></object>    

<div class="container">
<div class="page-header">
        <h2 style="margin-top:20px;margin-left:20px; text-align:center; ">IE中的WEB SOCKET连接控件测试</h2>
        <a href=http://local.zorrosoft.com/Files/WRL.zip>演示版下载</a>
        <br /></div>
    <div class="row" style="margin-bottom:20px;">
        <div class="col-sm-6 col-md-5 col-lg-4">
            <div>
                <input type="text" class="form-control" size="80" style="margin-bottom:3px;" id="inp_url" placeholder="连接" value="ws://localhost?sid=111&flag=1" />
                <button type="button" id="btn_conn" class="btn btn-primary" onclick="testwrl()">连接</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>